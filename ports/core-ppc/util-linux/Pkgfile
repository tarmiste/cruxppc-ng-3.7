# Description: Miscellaneous system utilities
# URL: https://github.com/karelzak/util-linux
# Maintainer: CRUX System Team, core-ports at crux dot nu
# Depends on: eudev file readline bzip2 xz

name=util-linux
version=2.37.2
release=1
source=(https://www.kernel.org/pub/linux/utils/$name/v${version:0:4}/$name-$version.tar.xz
	$name-man-$version.tar.xz)

build() {
	cd $name-$version

	./configure \
		--prefix=/usr \
		--disable-nls \
		--disable-asciidoc \
		--disable-{login,su,sulogin,nologin,runuser} \
		--disable-chfn-chsh \
		--enable-{write,kill} \
		--without-python

	make
	make DESTDIR=$PKG install

	install -d $PKG/{etc,var/{lib/libuuid,run/uuidd}}
	touch $PKG/etc/adjtime
	cp -r $SRC/man $PKG/usr/share

	rm -r $PKG/usr/share/{doc,bash-completion}
	rm $PKG/sbin/{mkfs.bfs,mkfs.minix,fsck.minix}
	rm $PKG/usr/share/man/man8/{fsck.minix,mkfs.bfs,mkfs.minix}.8
}
